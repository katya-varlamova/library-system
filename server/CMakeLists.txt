cmake_minimum_required(VERSION 3.19)
project(src)

set(CMAKE_CXX_STANDARD 17)

find_package(SOCI REQUIRED)
find_package(PostgreSQL REQUIRED)
find_package(oatpp REQUIRED)
find_package(oatpp-swagger REQUIRED)
find_package(jsoncpp REQUIRED)
find_package(MySQL REQUIRED)
find_package(jwt-cpp REQUIRED)
add_library(jsoncpp SHARED IMPORTED Logic/Server/Controller/JWTAuth.cpp Logic/Server/Controller/JWTAuth.h)

# add_library(PostgreSQL SHARED IMPORTED)

set_target_properties(jsoncpp PROPERTIES
        IMPORTED_LOCATION "/usr/local/Cellar/jsoncpp/1.9.4_1/lib/libjsoncpp.24.dylib"
        INTERFACE_INCLUDE_DIRECTORIES "/usr/local/Cellar/jsoncpp/1.9.4_1/include/json"
        )

#set_target_properties(PostgreSQL PROPERTIES
#        IMPORTED_LOCATION "/usr/local/Cellar/postgresql@14/14.5_4/lib/postgresql@14/libpq.dylib"
#        INTERFACE_INCLUDE_DIRECTORIES "/usr/local/Cellar/postgresql@14/14.5_4/include/postgresql@14"
#        )

add_executable(src main.cpp  Database/SqlIoc/SqlIoc.h Database/SqlIoc/IocRepository.h Database/Entities/DBEBook/IEBookRepository.h Database/Entities/DBEBook/EBookRepository.cpp Database/Entities/DBEBook/EBookRepository.h Database/Entities/DBEBook/DBEBook.h Database/Entities/DBEBook/DBEBookMappings.h Database/Entities/DBEBook/EBookConverter.h Database/Entities/DBEBook/EBookSpecifications/EBookSpecification.h Logic/Entities/EBook/EBook.cpp Logic/Entities/EBook/EBook.h Database/DataAccessFacade/Commands/EBookCommands/AddEBooksCommand.h Database/DataAccessFacade/Commands/EBookCommands/GetEBooksCommand.h Database/DataAccessFacade/Commands/EBookCommands/UpdateEBookCommand.h Database/DataAccessFacade/Commands/EBookCommands/DeleteEBookCommand.h Logger/Logger.cpp Database/Entities/DBBook/DBBook.cpp Database/Entities/DBBook/DBBook.h Database/Entities/DBBook/BookRepository.cpp Database/Entities/DBBook/BookRepository.h Database/Entities/DBAccount/DBAccount.h Database/Entities/DBAccount/AccountRepository.cpp Database/Entities/DBAccount/AccountRepository.h Database/Entities/DBAccount/AccountSpecifications/AccountSpecification.h Database/DataAccessFacade/DataAccessFacade.cpp Database/DataAccessFacade/DataAccessFacade.h Database/Connection/IConnectionPool.cpp Database/Connection/IConnectionPool.h Database/DataAccessFacade/Commands/Command.cpp Database/DataAccessFacade/Commands/Command.h Database/DataAccessFacade/Commands/AuthCommand/AuthCommand.h Database/DataAccessFacade/Commands/AuthCommand/AuthCommand.cpp Logic/Entities/Book/Book.cpp Logic/Entities/Book/Book.h Logic/Entities/Library/Library.cpp Logic/Entities/Library/Library.h Logic/Entities/Account/Account.cpp Logic/Entities/Account/Account.h Database/Entities/DBLibrary/DBLibrary.cpp Database/Entities/DBLibrary/DBLibrary.h Database/Entities/DBLibrary/LibraryRepository.cpp Database/Entities/DBLibrary/LibraryRepository.h Database/Entities/DBBook/BookSpecifications/BookSpecification.cpp Database/Entities/DBBook/BookSpecifications/BookSpecification.h Database/Entities/DBAccount/AccountConverter.h Logic/LogicException.cpp Logic/LogicException.h Database/DataAccessFacade/Commands/RegisterCommand/RegisterAdminCommand.cpp Database/DataAccessFacade/Commands/RegisterCommand/RegisterAdminCommand.h Database/DataAccessFacade/Commands/CreateDatabaseCommand/CreateDatabaseCommand.cpp Database/DataAccessFacade/Commands/CreateDatabaseCommand/CreateDatabaseCommand.h Database/Entities/DBBook/BookConverter.cpp Database/Entities/DBBook/BookConverter.h Database/Entities/DBLibrary/LibrarySpecifications/LibarySpecification.h Database/Entities/DBLibrary/LibraryConverter.cpp Database/Entities/DBLibrary/LibraryConverter.h Logic/DataAccessManager/DataAccessManager.cpp Logic/DataAccessManager/DataAccessManager.h Database/DataAccessFacade/Commands/AddBooksCommand/AddBooksCommand.cpp Database/DataAccessFacade/Commands/AddBooksCommand/AddBooksCommand.h Database/Entities/DBBook/DBBookMappings.h Database/Entities/DBBook/BookSpecifications/TakeBookSpecification.cpp Database/Entities/DBBook/BookSpecifications/TakeBookSpecification.h Database/DatabseException.cpp Database/DatabseException.h Logic/Server/Controller/ServerController.h Logic/Server/DTOs/DTOs.h Logic/Server/ServerSettings/ServerSettings.h Database/DataAccessFacade/Commands/DeleteDatabaseCommand/DeleteDatabaseCommand.cpp Database/DataAccessFacade/Commands/DeleteDatabaseCommand/DeleteDatabaseCommand.h Database/Connection/Session.cpp Database/Connection/Session.h Database/Entities/DBBook/BookFilters/BookFilter.h Database/Entities/DBBook/BookFilters/ByBookNameFilter.h Database/Entities/DBBook/BookFilters/ByAuthorFilter.h Database/Entities/DBBook/BookSpecifications/GetFreeBooks.cpp Database/Entities/DBBook/BookSpecifications/GetFreeBooks.h Database/Entities/DBLibrary/LibraryFilters/LibraryFilter.h Database/Entities/DBLibrary/LibraryFilters/ByAddressFilter.h Database/Entities/DBLibrary/LibraryFilters/ByLibraryNameFilter.h Database/Entities/DBLibrary/LibraryFilters/ByLibraryIDFilter.h Database/Entities/DBLibrary/LibrarySpecifications/GetLibrary.cpp Database/Entities/DBLibrary/LibrarySpecifications/GetLibrary.h Database/Entities/DBAccount/AccountFilters/ByLoginFilter.h Database/Entities/DBAccount/AccountFilters/AccountFilter.h Database/Entities/DBAccount/AccountFilters/ByAccountIDFilter.h Database/Entities/DBAccount/AccountSpecifications/GetAccount.cpp Database/Entities/DBAccount/AccountSpecifications/GetAccount.h Database/DataAccessFacade/Commands/Filters/Filter.h Database/DataAccessFacade/Commands/GetBooksCommands/GetFreeBooksCommand.cpp Database/DataAccessFacade/Commands/GetBooksCommands/GetFreeBooksCommand.h Database/DataAccessFacade/Commands/GetBooksCommands/GetBooksByLoginCommand.cpp Database/DataAccessFacade/Commands/GetBooksCommands/GetBooksByLoginCommand.h Database/Entities/DBBook/BookSpecifications/GetBooks.cpp Database/Entities/DBBook/BookSpecifications/GetBooks.h Logic/Entities/Account/LibrarianAccount.cpp Logic/Entities/Account/LibrarianAccount.h Database/Entities/DBAccount/LibrarianAccount/LibrarianAccountConverter.h Database/Entities/DBAccount/LibrarianAccount/DBLibrarianAccount.h Database/Entities/DBAccount/ReaderAccount/DBReaderAccount.h Database/Entities/DBAccount/ReaderAccount/ReaderAccountConverter.h Logic/Entities/Account/ReaderAccount.cpp Logic/Entities/Account/ReaderAccount.h Logic/Entities/Account/AdminAccount.cpp Logic/Entities/Account/AdminAccount.h Database/Entities/DBAccount/AdminAccount/DBAdminAccount.h Database/Entities/DBAccount/AdminAccount/AdminAccountConverter.h Database/Entities/DBAccount/AdminAccount/AdminAccountRepository.cpp Database/Entities/DBAccount/AdminAccount/AdminAccountRepository.h Database/Entities/DBAccount/LibrarianAccount/LibrarianAccountRepository.cpp Database/Entities/DBAccount/LibrarianAccount/LibrarianAccountRepository.h Database/Entities/DBAccount/ReaderAccount/ReaderAccountRepository.cpp Database/Entities/DBAccount/ReaderAccount/ReaderAccountRepository.h Database/Entities/DBAccount/AdminAccount/AdminAccountSpecifications/GetAdminAccount.cpp Database/Entities/DBAccount/AdminAccount/AdminAccountSpecifications/GetAdminAccount.h Database/Entities/DBAccount/AdminAccount/AdminAccountSpecifications/AdminAccountSpecification.h Database/Entities/DBAccount/LibrarianAccount/LibrarianAccountSpecifications/GetLibrarianAccount.cpp Database/Entities/DBAccount/LibrarianAccount/LibrarianAccountSpecifications/GetLibrarianAccount.h Database/Entities/DBAccount/LibrarianAccount/LibrarianAccountSpecifications/LibrarianAccountSpecification.h Database/Entities/DBAccount/ReaderAccount/ReaderAccountSpecifications/ReaderAccountSpecification.h Database/Entities/DBAccount/ReaderAccount/ReaderAccountSpecifications/GetReaderAccount.cpp Database/Entities/DBAccount/ReaderAccount/ReaderAccountSpecifications/GetReaderAccount.h Database/DataAccessFacade/Commands/RegisterCommand/RegisterReaderCommand.cpp Database/DataAccessFacade/Commands/RegisterCommand/RegisterReaderCommand.h Database/DataAccessFacade/Commands/RegisterCommand/RegisterLibrarianCommand.cpp Database/DataAccessFacade/Commands/RegisterCommand/RegisterLibrarianCommand.h Database/Entities/DBBook/BookSpecifications/ReturnBookSpecification.cpp Database/Entities/DBBook/BookSpecifications/ReturnBookSpecification.h Database/DataAccessFacade/Commands/TakeBookCommand/TakeBookCommand.cpp Database/DataAccessFacade/Commands/TakeBookCommand/TakeBookCommand.h Database/DataAccessFacade/Commands/ReturnBookCommand/ReturnBookCommand.cpp Database/DataAccessFacade/Commands/ReturnBookCommand/ReturnBookCommand.h Database/DataAccessFacade/Commands/GetAccounts/GetReaderAccountCommand.h Database/DataAccessFacade/Commands/GetAccounts/GetLibrarianAccountCommand.h Database/DataAccessFacade/Commands/UpdateAccounts/UpdateLibrarianAccountCommand.h Database/DataAccessFacade/Commands/UpdateAccounts/UpdateReaderAccountCommand.h Database/DataAccessFacade/Commands/UpdateAccounts/UpdateAdminAccountCommand.h Database/DataAccessFacade/Commands/GetLibraries/GetlibrariesCommand.cpp Database/DataAccessFacade/Commands/GetLibraries/GetlibrariesCommand.h Database/DataAccessFacade/Commands/GetLibraries/UpdateLibraries.cpp Database/DataAccessFacade/Commands/GetLibraries/UpdateLibraries.h Database/DataAccessFacade/Commands/GetLibraries/PostLibrariesCommand.cpp Database/DataAccessFacade/Commands/GetLibraries/PostLibrariesCommand.h Database/DataAccessFacade/Commands/GetBooksCommands/UpdateBookCommand.cpp Database/DataAccessFacade/Commands/GetBooksCommands/UpdateBookCommand.h Database/DataAccessFacade/Commands/GetBooksCommands/DeleteBooksCommand.cpp Database/DataAccessFacade/Commands/GetBooksCommands/DeleteBooksCommand.h Database/Entities/DBBook/BookSpecifications/GetBooks.cpp Database/Entities/DBBook/BookSpecifications/GetBooks.h Database/DataAccessFacade/Commands/GetLibraries/DeleteLibrariesCommand.cpp Database/DataAccessFacade/Commands/GetLibraries/DeleteLibrariesCommand.h Database/DataAccessFacade/Commands/DeleteAccounts/DeleteReaderAccountCommand.h Database/DataAccessFacade/Commands/DeleteAccounts/DeleteAdminAccountCommand.h Database/DataAccessFacade/Commands/DeleteAccounts/DeleteLibrarianAccountCommand.h Database/Entities/DBAccount/IAccountRepository.h Database/Entities/DBAccount/ReaderAccount/IReaderAccountRepository.h Database/Entities/DBAccount/LibrarianAccount/ILibrarianAccountRepository.h Database/Entities/DBAccount/AdminAccount/IAdminAccountRepository.h Database/Entities/DBBook/IBookRepository.h Database/Entities/DBLibrary/ILibraryRepository.h Logic/Server/ServerSettings/IocRepositories.h Logic/Configuration/Configuration.h Database/Connection/SociConnectionPool.cpp Database/Connection/SociConnectionPool.h Database/Connection/RoleConnection.h Logic/Configuration/FileConfiguration.cpp Logic/Configuration/FileConfiguration.h Database/Entities/DBEBook/EBookSpecifications/GetEBooksSpecification.cpp Database/Entities/DBEBook/EBookSpecifications/GetEBooksSpecification.h Logic/DataAccessManager/DataAccessManagerRest.cpp Logic/DataAccessManager/DataAccessManagerRest.h)

target_link_libraries(src PRIVATE SOCI::soci_core SOCI::soci_postgresql PostgreSQL::PostgreSQL oatpp::oatpp oatpp::oatpp-swagger jsoncpp jwt-cpp::jwt-cpp)

add_definitions(
        -DOATPP_SWAGGER_RES_PATH="${OATPP_BASE_DIR}/bin/oatpp-swagger/res"
)